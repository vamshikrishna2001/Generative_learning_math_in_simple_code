math is in linear implementation
